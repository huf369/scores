<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- 引入 jQuery Mobile 样式 -->
    <link rel="stylesheet" href="http://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <!-- 引入 jQuery 库 -->
    <script src="http://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
    <!-- 引入 jQuery Mobile 库 -->
    <script src="http://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <title>项目</title>
</head>
<body>
<script type="text/javascript">
    function verify() {
        if ($(this '#itemname').val() == "") {
            alert("项目不能为空");
            return false;
        }

        if ($('#itemscore').val() == "") {
            alert("分数不能为空");
            return false;
        }

        return true
    }

    function additem(name, score) {
        if (false == verify()) {
            return;
        }
        $.ajax({
            url:"/person/add",
            type:"post",
            data:{itemname:name,itemscore:score},
            async:false,
            success: function(data){
                $("#itemsbody").append('<tr id='+data.id+'><td>'+ data.name + '</td><td>'+ data.score + '</td>' +
                    '<td><a href=\"/person/detail?id=' + data.id + '\">明细</a>&nbsp;&nbsp;<a href=\"/person/history?id='+data.id+'\">历史</a>&nbsp;&nbsp;<a href=\"\" onclick=\"javascript:deleteperson('+data.id+')\">删除</a></td></tr>');
            }
        });
    }

    function deleteitem(id) {
        $.ajax({
            url:"/item/delete",
            type:"get",
            data:{id:id},
            async:false,
            success: function(){
                $("#"+id).remove();
            }
        });
    }
</script>
<div data-role="page">
  <div data-role="header">
      <h1>项目</h1>
  </div>
  <div data-role="main" class="ui-content">
       <table>
           <tbody id="itemsbody">
               {% for item in items %}
                    <tr id="{{ item.id }}">
                        <td> {{ item.name }} </td>
                        <td> {{ item.score }} </td>
                        <td><a href="#add" data-rel="popup">编辑</a>&nbsp;&nbsp;<a href="" onclick="javascript:deleteitem({{ item.id }})">删除</a></td>
                    </tr>
               {% endfor %}
           </tbody>
       </table>

  </div>
  <div data-role="footer">
      <h1><a href="#add" data-rel="popup" class="ui-btn ui-btn-inline ui-corner-all">添加</a></h1>
      <div data-role="popup" id="add" style="margin: 20rem, width=400rem">
          项目：<input type="text" name="itemname" id="itemname">
          分数：<input type="text" name="itemscore" id="itemcore">
          <input>
          <input onclick="javascript:additem($('#itemname').val(),$('#itemcore').val())" type="submit" value="添加" data-transition="slide">
      </div>
  </div>
</div>
</body>
</html>